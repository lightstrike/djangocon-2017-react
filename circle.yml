dependencies:
    pre:
        - cd /opt/circleci/.pyenv; git pull
        - pip install -r requirements-dev.txt
machine:
  python:
    version: 3.6.2
  node:
    version: 6.11.1

database:
  override:
    - createuser -s -d djangoconreact
    - createdb djangoconreact

test:
  override:
    - npm rebuild node-sass
    - webpack --config webpack.config.js
    - flake8
    - dropdb djangoconreact
    - coverage run manage.py test
  post:
    - coverage html --omit '*virtualenvs*' -d $CIRCLE_ARTIFACTS
